{"version":3,"sources":["webpack://OUYO/webpack/universalModuleDefinition","webpack://OUYO/webpack/bootstrap","webpack://OUYO/./src/Entity.js","webpack://OUYO/./src/Events.js","webpack://OUYO/./src/Game.js","webpack://OUYO/./src/Query.js","webpack://OUYO/./src/assert.js","webpack://OUYO/./src/index.js","webpack://OUYO/./src/ticker.js"],"names":["Entity","registerChange","_components","Object","create","_changeRegistered","_registerChange","instance","assert","Component","constructor","id","_onChange","component","undefined","Events","_events","_eventTimes","event","time","type","lastTime","timeDelta","push","eventType","filter","length","Game","onTick","_changed","_removed","_systems","_queries","_componentCount","_started","_time","_onTick","_onEntityChange","entity","_proxy","createEntity","_createEntity","assemblage","removeEntity","_removeEntity","emit","_emit","fields","createComponent","systems","forEach","registerSystem","system","query","unifyQuery","on","process","createProcess","processEntity","subQueries","subQuery","init","_update","clear","_runSystem","get","_handleChanges","entities","forEach2","handleEntityChange","handleEntityRemove","game","i","onChange","onChangeRegistered","onRemove","Query","selector","_selector","_entities","Set","add","delete","condition","errorMessage","Error","defaultTicker","update","window","requestAnimationFrame","onAnimationFrame","Date","now","Math","min"],"mappings":"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","file":"ouyo.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"OUYO\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"OUYO\"] = factory();\n\telse\n\t\troot[\"OUYO\"] = factory();\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/index.js\");\n","import { assert } from './assert'\n\nexport class Entity {\n  constructor (registerChange) {\n    this._components = Object.create(null)\n    this._changeRegistered = false\n    this._registerChange = registerChange\n  }\n\n  add (instance) {\n    assert(instance != null, `Entity.add :: Argument is ${instance}.`)\n\n    const Component = instance.constructor\n\n    assert(Component && Component.id, 'Entity.add :: Argument is not a component instance.')\n    assert(!this._components[Component.id], `Entity.add :: Component \"${Component.id}\" is already present.`)\n\n    this._components[Component.id] = instance\n    this._onChange()\n\n    return this\n  }\n\n  has (Component) {\n    assert(Component && Component.id, 'Entity.has :: Argument is not a component.')\n    return !!this._components[Component.id]\n  }\n\n  get (Component) {\n    assert(Component && Component.id, 'Entity.get :: Argument is not a component.')\n    const component = this._components[Component.id]\n    assert(component, `Entity.get :: Component \"${Component.id}\" is not present.`)\n    return component\n  }\n\n  remove (Component) {\n    assert(Component && Component.id, 'Entity.remove :: Argument is not a component.')\n\n    this._components[Component.id] = undefined\n    this._onChange()\n\n    return this\n  }\n\n  _onChange () {\n    if (!this._changeRegistered) {\n      this._registerChange(this)\n    }\n    this._changeRegistered = true\n  }\n\n  _onChangeRegistered () {\n    this._changeRegistered = false\n  }\n}\n","export class Events {\n  constructor () {\n    this._events = []\n    this._eventTimes = {}\n  }\n\n  emit (event, time) {\n    if (typeof event === 'string') {\n      event = { type: event }\n    }\n    const lastTime = this._eventTimes[event.type] != null\n      ? this._eventTimes[event.type]\n      : time\n\n    event.timeDelta = (time - lastTime) / 1000\n    this._eventTimes[event.type] = time\n    this._events.push(event)\n  }\n\n  get (eventType) {\n    return this._events.filter(\n      event => event.type === eventType\n    )\n  }\n\n  clear () {\n    this._events.length = 0\n  }\n}\n","import { Entity } from './Entity'\nimport { Events } from './Events'\nimport { unifyQuery } from './Query'\nimport { assert, forEach, forEach2 } from './utils'\nimport { createComponent } from './component'\nimport { defaultTicker } from './ticker'\n\nexport class Game {\n  constructor (onTick = defaultTicker) {\n    this._changed = []\n    this._removed = []\n\n    this._systems = []\n    this._queries = []\n\n    this._events = new Events()\n\n    this._componentCount = 0\n\n    this._started = false\n    this._time = 0\n    this._onTick = onTick\n\n    this._onEntityChange = entity => this._changed.push(entity)\n\n    this._proxy = {\n      createEntity: assemblage => this._createEntity(assemblage),\n      removeEntity: entity => this._removeEntity(entity),\n      emit: event => this._emit(event)\n    }\n  }\n\n  createComponent (...fields) {\n    assert(!this._started, 'Cannot create component after the game was started.')\n    return createComponent(fields, this._componentCount++)\n  }\n\n  registerSystems (systems) {\n    forEach(systems, system => this.registerSystem(system))\n  }\n\n  registerSystem (system) {\n    assert(!this._started, 'Cannot register systems after the game was started.')\n\n    const query = unifyQuery(system.query)\n\n    this._systems.push({\n      query,\n      on: system.on || 'tick',\n      process: system.process || createProcess(system.processEntity)\n    })\n\n    forEach(\n      query.subQueries,\n      subQuery => this._queries.push(subQuery)\n    )\n  }\n\n  start (init) {\n    assert(!this._started, 'A game can only be started once!')\n    this._started = true\n\n    init(this._proxy)\n\n    this._onTick(timeDelta => this._update(timeDelta))\n  }\n\n  _update (timeDelta) {\n    this._time += timeDelta\n    this._events.clear()\n    this._emit('tick')\n    forEach(this._systems, system => this._runSystem(system))\n  }\n\n  _runSystem (system, timeDelta) {\n    forEach(\n      this._events.get(system.on),\n      event => {\n        this._handleChanges()\n        system.process(system.query.entities, event, this._proxy)\n      }\n    )\n  }\n\n  _handleChanges () {\n    forEach2(this._changed, this._queries, handleEntityChange)\n    this._changed.length = 0\n\n    forEach2(this._removed, this._queries, handleEntityRemove)\n    this._removed.length = 0\n  }\n\n  _createEntity (assemblage) {\n    assert(this._started, 'Entities cannot be created before the game is started.')\n    const entity = new Entity(this._componentCount, this._onEntityChange)\n    if (assemblage) {\n      assemblage(entity)\n    }\n    return entity\n  }\n\n  _removeEntity (entity) {\n    assert(this._started, 'Entities cannot be removed before the game is started.')\n    this._removed.push(entity)\n  }\n\n  _emit (event) {\n    this._events.emit(event, this._time)\n  }\n}\n\nfunction createProcess (processEntity) {\n  return function (entities, event, game) {\n    for (let i = 0; i < entities.length; ++i) {\n      processEntity(entities[i], event, game)\n    }\n  }\n}\n\nfunction handleEntityChange (entity, query) {\n  query.onChange(entity)\n  entity.onChangeRegistered()\n}\n\nfunction handleEntityRemove (entity, query) {\n  query.onRemove(entity)\n}\n","import { assert } from './assert'\n\nexport class Query {\n  constructor (selector) {\n    assert(typeof selector === 'function', 'new Query :: selector must be a function')\n    this._selector = selector\n    this._entities = new Set()\n  }\n\n  get entities () {\n    return this._entities\n  }\n\n  onChange (entity) {\n    if (this._selector(entity)) {\n      this._entities.add(entity)\n    } else {\n      this._entities.delete(entity)\n    }\n  }\n\n  onRemove (entity) {\n    this._entities.delete(entity)\n  }\n}\n","export function assert (condition, errorMessage) {\n  if (!condition) {\n    throw new Error(errorMessage)\n  }\n}\n","export { Game } from './Game'\nexport { Query } from './Query'\n","export const defaultTicker = function (update) {\n  window.requestAnimationFrame(onAnimationFrame)\n  let lastTime = Date.now()\n  function onAnimationFrame () {\n    window.requestAnimationFrame(onAnimationFrame)\n    let now = Date.now()\n    update(Math.min(now - lastTime, 100))\n    lastTime = now\n  }\n}\n"],"sourceRoot":""}